/**
* @File Name          : SHF_SearchCustomerLMSService_Test.cls
* @Description        : Test class to cover SHF_SearchCustomerLMSService.
* @Author             : Kunal Soni
* 
* ==============================================================================
* Ver         Date         Author       Modification
* ==============================================================================
* 1.0         19-08-2025   Kunal Soni   Initial Version
*/
@Istest
public class SHF_SearchCustomerLMSService_Test {
    // Mock class to simulate successful HTTP response
    private class SMSHttpMockSuccess implements HttpCalloutMock {
        public HTTPResponse respond(HTTPRequest req) {
            HttpResponse res = new HttpResponse();
            res.setHeader('Content-Type', 'application/json');
            res.setBody('{"status":"SUCCESS","messageCode":null,"messageDescription":null,"queryTimestamp":1755593582428,"requestReferenceNumber":"123445","searchResult":[{"customerInfoFileNumber":"GLBCUST00005002661","hostCustomerInfoFileNumber":null,"customerRecord":{"recordId":3887,"customerType":"individual","sourceSystem":"FINNONE_NEO_CAS","hostCIFNumber":null,"customerInfoFileNumber":null,"associatedLoanAppId":null,"personInfo":{"recordId":3887,"salutationCode":"MS","salutationId":null,"firstName":"prabha","middleName":null,"lastName":"devi","fourthName":null,"fullName":"prabha devi","aliasName":null,"genderCode":"FEMALE","genderId":null,"fatherName":null,"mothersMaidenName":"leela  wati","husbandName":null,"guardianName":null,"dateOfBirth":497637000000,"placeOfBirth":"G B NAGAR","maritalStatusCode":"Married","maritalStatusId":null,"constitutionCode":"Indivi","constitutionId":null,"customerSegmentCode":"NewCustomer","customerSegmentId":null,"customerCategoryCode":"General","customerCategoryId":null,"householdTypeCode":null,"householdTypeId":null,"nationality":"Indian","residentType":null,"residentTypeId":null,"disability":null,"disabilityId":null,"relationshipType":null,"relationshipTypeId":null,"bankEmpId":null,"bankEmpName":null,"dynamicFormJson":null,"accountType":null,"accountTypeId":null,"maidenSalutation":null,"maidenSalutationId":null,"maidenFirstName":null,"maidenMiddleName":null,"maidenLastName":null,"religion":null,"religionTypeId":null,"photoUrl":null,"signatureUrl":null,"ekycFlag":null,"ekycMethod":null,"consentReceived":null,"consentImageVersion":null,"consentImage":null,"ekycVerificationType":null},"contactInfo":[{"clientId":null,"gcdId":null,"recordId":4145,"preferredTelephoneType":null,"addressInfo":[{"primaryAddress":false,"addressInfoPojo":{"clientId":null,"gcdId":null,"recordId":8133,"addressTypeCode":"ResidentialAddress","addressTypeId":null,"accomodationTypeCode":"SELF","accomodationTypeId":null,"addressLine1":"House no-548,Chipiyana khurd ","addressLine2":"Tigri, Gautam Budh nagar","addressLine3":"Near sai Enclave","addressLine4":null,"sanitizedFullAddress":null,"area":null,"areaId":null,"villageCode":null,"villageId":null,"village":"AMRAVATI ","city":"GZB","cityId":null,"district":"32527","districtId":null,"state":"UP","stateId":null,"country":"IND","countryId":null,"zipcode":"201009","zipcodeId":null,"region":"NR","regionId":null,"landMark":"Near Sai Enclave","taluka":"Gautam budh nagar","talukaId":null,"residenceTypeCode":"Row House","residenceTypeId":null,"numberOfYearsAtAddress":null,"numberOfMonthsAtAddress":null,"yearsInCurrentCity":null,"monthsInCurrentCity":null,"phoneNumbers":[{"clientId":null,"gcdId":null,"recordId":53776,"telephoneExtension":null,"isdCode":"+91","telephoneTypeCode":"Mobile","telephoneTypeId":null,"telephoneNumber":"7503453671","stdCode":null,"countryCode":"IN","verified":false,"phoneConnectionType":null,"phoneConnectionTypeId":null,"mappingChanged":false}],"tehsil":null,"tehsilId":null,"activeAddress":true,"additionalAddressPurpose":null,"additionalAddressPurposeId":null,"additionalField1":null,"additionalField2":null,"additionalField3":null,"additionalField4":null,"additionalField5":null,"remarks":null,"addressGeneric":null,"addressGenericId":null,"primaryAddress":false,"verified":null,"streetType":null,"completeAddress":null,"streetTypeId":null,"gstInDetailsPojo":[],"additionalDropdownField1":null,"additionalDropdownField2":null,"atCurrentAddressFrom":null,"atCurrentAddressTo":null,"atCurrentCityFrom":null,"atCurrentCityTo":null,"currentAddress":false,"postCodeType":null,"mappingChanged":false}},{"primaryAddress":true,"addressInfoPojo":{"clientId":null,"gcdId":null,"recordId":8134,"addressTypeCode":"PermanentAddress","addressTypeId":null,"accomodationTypeCode":"SELF","accomodationTypeId":null,"addressLine1":"House no-548,Chipiyana khurd ","addressLine2":"Tigri, Gautam Budh nagar","addressLine3":"Near sai Enclave","addressLine4":null,"sanitizedFullAddress":null,"area":null,"areaId":null,"villageCode":null,"villageId":null,"village":"AMRAVATI ","city":"GZB","cityId":null,"district":"32527","districtId":null,"state":"UP","stateId":null,"country":"IND","countryId":null,"zipcode":"201009","zipcodeId":null,"region":"NR","regionId":null,"landMark":"Near Sai Enclave","taluka":"Gautam budh nagar","talukaId":null,"residenceTypeCode":"Row House","residenceTypeId":null,"numberOfYearsAtAddress":null,"numberOfMonthsAtAddress":null,"yearsInCurrentCity":null,"monthsInCurrentCity":null,"phoneNumbers":[{"clientId":null,"gcdId":null,"recordId":53775,"telephoneExtension":null,"isdCode":"+91","telephoneTypeCode":"Mobile","telephoneTypeId":null,"telephoneNumber":"7503453671","stdCode":null,"countryCode":"IN","verified":false,"phoneConnectionType":null,"phoneConnectionTypeId":null,"mappingChanged":false}],"tehsil":null,"tehsilId":null,"activeAddress":true,"additionalAddressPurpose":null,"additionalAddressPurposeId":null,"additionalField1":null,"additionalField2":null,"additionalField3":null,"additionalField4":null,"additionalField5":null,"remarks":null,"addressGeneric":null,"addressGenericId":null,"primaryAddress":false,"verified":null,"streetType":null,"completeAddress":null,"streetTypeId":null,"gstInDetailsPojo":[],"additionalDropdownField1":null,"additionalDropdownField2":null,"atCurrentAddressFrom":null,"atCurrentAddressTo":null,"atCurrentCityFrom":null,"atCurrentCityTo":null,"currentAddress":false,"postCodeType":null,"mappingChanged":false}},{"primaryAddress":false,"addressInfoPojo":{"clientId":null,"gcdId":null,"recordId":8135,"addressTypeCode":"OfficeAddress","addressTypeId":null,"accomodationTypeCode":null,"accomodationTypeId":null,"addressLine1":"Saraswati Kunj","addressLine2":"Shop no-1, Chipiyana Kurd ,Tigri ,GB Nagar","addressLine3":null,"addressLine4":null,"sanitizedFullAddress":null,"area":null,"areaId":null,"villageCode":null,"villageId":null,"village":"AMRAVATI","city":"GZB","cityId":null,"district":"32527","districtId":null,"state":"UP","stateId":null,"country":"IND","countryId":null,"zipcode":"201009","zipcodeId":null,"region":"NR","regionId":null,"landMark":"Near Sai Enclave ","taluka":"Gautam budh nagar","talukaId":null,"residenceTypeCode":null,"residenceTypeId":null,"numberOfYearsAtAddress":null,"numberOfMonthsAtAddress":null,"yearsInCurrentCity":null,"monthsInCurrentCity":null,"phoneNumbers":[{"clientId":null,"gcdId":null,"recordId":53774,"telephoneExtension":null,"isdCode":"+91","telephoneTypeCode":"Mobile","telephoneTypeId":null,"telephoneNumber":"7503453671","stdCode":null,"countryCode":"IN","verified":false,"phoneConnectionType":null,"phoneConnectionTypeId":null,"mappingChanged":false}],"tehsil":null,"tehsilId":null,"activeAddress":true,"additionalAddressPurpose":null,"additionalAddressPurposeId":null,"additionalField1":null,"additionalField2":null,"additionalField3":null,"additionalField4":null,"additionalField5":null,"remarks":null,"addressGeneric":null,"addressGenericId":null,"primaryAddress":false,"verified":null,"streetType":null,"completeAddress":null,"streetTypeId":null,"gstInDetailsPojo":[],"additionalDropdownField1":null,"additionalDropdownField2":null,"atCurrentAddressFrom":null,"atCurrentAddressTo":null,"atCurrentCityFrom":null,"atCurrentCityTo":null,"currentAddress":false,"postCodeType":null,"mappingChanged":false}}],"emailInfo":[{"clientId":null,"gcdId":null,"recordId":43555,"emailAddress":"guptadheeraj07@gmail.com","primaryEmail":true,"emailTypeCode":null,"mappingChanged":false}],"telephoneInfo":[{"primaryTelephone":true,"phoneNumbers":{"clientId":null,"gcdId":null,"recordId":3320242,"telephoneExtension":null,"isdCode":"+91","telephoneTypeCode":"Mobile","telephoneTypeId":2762,"telephoneNumber":"9694233493","stdCode":null,"countryCode":"IN","verified":false,"phoneConnectionType":null,"phoneConnectionTypeId":null,"mappingChanged":false}}],"prefferedLanguage":"Hindi","prefferedLanguageId":null,"defaultContactInfo":true,"faxNumber":null,"associatedLoanAppId":"APPL05001623","consentToCall":null,"mappingChanged":false}],"institutionInfo":null,"identificationInfo":[{"clientId":null,"gcdId":null,"recordId":1027000,"expiryDate":null,"identificationNumber":"CJTPD4873Q","identificationTypeCode":"PAN","identificationTypeId":null,"issueDate":null,"issuingCountry":null,"associatedLoanAppId":null,"primaryId":true,"consent":null,"isRefNumber":null,"referenceNumber":null,"mappingChanged":false},{"clientId":null,"gcdId":null,"recordId":1026999,"expiryDate":null,"identificationNumber":"000000007291","identificationTypeCode":"AAdhar_No","identificationTypeId":null,"issueDate":null,"issuingCountry":null,"associatedLoanAppId":null,"primaryId":false,"consent":null,"isRefNumber":null,"referenceNumber":null,"mappingChanged":false}],"bankDetails":[{"clientId":null,"gcdId":null,"recordId":857,"branchName":"Gautam budh nagar","branchId":null,"accountTypeCode":"SavingAccount","accountTypeId":null,"accountNumber":"29820110022795","bankName":"UCO BANK","bankId":null,"associatedLoanAppId":"APPL05001623","accountOpeningDate":null,"accountValidatedDate":null,"numberOfMonthsAccHeld":null,"remarks":null,"minimumBalance":null,"maximumBalance":null,"avgBalance":null,"bounceCheques":null,"bankName1":"UCO BANK","bankingSince":null,"iwChequeReturns":null,"owChequeReturns":null,"totalCredit":null,"otherBankBranch":null,"accountSubTypeCode":null,"accountSubTypeId":null,"considerForConsolidatedABB":null,"applicantName":null,"bankDetailFileName":null,"bankDetailFileCouchDbId":null,"bankDetailFileHist":[],"bankDetailPerfiosFileHist":[],"isManualEntry":null,"numberofCreditTransactions":null,"numberofDebitTransactions":null,"isSalaryAccount":false,"isCreateAccount":null,"isRepaymentAccount":false,"isSalaryAccountType":false,"ifscCode":null,"avgBalanceThreeMonths":null,"avgBalanceSixMonths":null,"avgBalanceNineMonths":null,"avgBalanceTwelveMonths":null,"resultScore":null,"branchName2":"Gautam budh nagar","accountStatus":null,"tempBankBranchCode":null,"tempBankBranchId":null,"tempIfscCodeCode":null,"tempIfscCodeId":null,"withdrawalAmount":null,"additionalMoneyField1":null,"additionalMoneyField2":null,"additionalMoneyField3":null,"additionalMoneyField4":null,"additionalMoneyField5":null,"additionalMoneyField6":null,"additionalMoneyField7":null,"additionalMoneyField8":null,"additionalMoneyField9":null,"additionalMoneyField10":null,"additionalMoneyField11":null,"additionalMoneyField12":null,"additionalMoneyField13":null,"additionalMoneyField14":null,"additionalMoneyField15":null,"additionalMoneyField16":null,"additionalMoneyField17":null,"additionalMoneyField18":null,"additionalMoneyField19":null,"additionalMoneyField20":null,"additionalNumericField1":null,"additionalNumericField2":null,"additionalNumericField3":null,"additionalNumericField4":null,"additionalNumericField5":null,"additionalNumericField6":null,"additionalNumericField7":null,"additionalNumericField8":null,"additionalNumericField9":null,"additionalNumericField10":null,"additionalNumericField11":null,"additionalNumericField12":null,"additionalNumericField13":null,"additionalNumericField14":null,"additionalNumericField15":null,"additionalNumericField16":null,"additionalNumericField17":null,"additionalNumericField18":null,"additionalNumericField19":null,"additionalNumericField20":null,"additionalNumericField21":null,"additionalNumericField22":null,"additionalNumericField23":null,"additionalNumericField24":null,"additionalNumericField25":null,"additionalNumericField26":null,"additionalNumericField27":null,"additionalNumericField28":null,"additionalNumericField29":null,"additionalNumericField30":null,"uploadedFileAccountType":null,"additionalAlphaNumericField1":null,"additionalAlphaNumericField2":null,"additionalAlphaNumericField3":null,"additionalAlphaNumericField4":null,"additionalAlphaNumericField5":null,"additionalAlphaNumericField6":null,"additionalAlphaNumericField7":null,"additionalAlphaNumericField8":null,"additionalAlphaNumericField9":null,"additionalAlphaNumericField10":null,"sourceSystem":null,"accountValidationDetailAccountNumber":null,"accountStatusTypeCode":null,"accountStatusTypeId":null,"bankSourcingSystemCode":null,"bankSourcingSystemId":null,"accountName":null,"bankingEvaluationPeriodCode":null,"bankingEvaluationPeriodId":null,"mappingChanged":false}],"creditCardDetails":null,"familyDetails":[{"clientId":null,"gcdId":null,"recordId":2384,"memberName":"ABHISHEK","relationshipCode":"Son","relationshipId":null,"dateOfBirth":null,"educationStatus":"HSC","phoneNumber":"9540758115","emailID":null,"occupation":null,"isDependent":true,"numberOfDependentChildren":null,"numberOfChildDependents":null,"numberOfAdultDependents":null,"age":null,"isMinor":null,"mappingChanged":false},{"clientId":null,"gcdId":null,"recordId":2383,"memberName":"SUDHIR","relationshipCode":"Spouse","relationshipId":null,"dateOfBirth":null,"educationStatus":"HSC","phoneNumber":"9540758115","emailID":null,"occupation":null,"isDependent":true,"numberOfDependentChildren":null,"numberOfChildDependents":null,"numberOfAdultDependents":null,"age":null,"isMinor":null,"mappingChanged":false}],"educationalDetail":null,"occupationInfo":null,"financialInfo":{"clientId":null,"gcdId":null,"recordId":102538,"assetDetail":[{"clientId":null,"gcdId":null,"recordId":4478,"incomeDetailAssetCategoryCode":"real_estate_assets","incomeDetailAssetCategoryId":null,"incomeDetailAssetTypeCode":"house","incomeDetailAssetTypeId":null,"description":"OWN HOUSE","assetValue":null,"remarks":null,"agricultureAssetDetail":null,"otherAssetDetails":null,"mappingChanged":false}],"liabilityDetail":[],"customerOtherIncomeDetails":[],"customerExpenseDetails":[],"agricultureIncomeDetails":null,"agricultureExpenseDetails":null,"cropIncomeDetails":null,"netMonthlyIncome":null,"totalAnnualIncome":null,"grossAnnualIncome":null,"totalOtherIncome":null,"mappingChanged":false},"customerSubGroupCode":null,"customerSubGroupId":null,"promoterContribution":null,"tanNumber":null,"gstDetailSearchByPanPojo":null,"gstAuthenticationDetailPojo":null,"gstTransactionReportPojo":null,"detailedCompanyProfilePojo":null,"lastUpdatedMillis":1752428017130,"additionalOccFinancialDetail":null,"isOccupationFinancialMappingExist":null,"updationTimeStamp":"13/07/2025 23:03:37.130","creationTimeStamp":"30/05/2016 17:25:24.156","numberOfDependents":null,"numberOfChildDependents":null,"numberOfAdultDependents":null,"numberOfChildren":null,"financialUploadData":null,"electricityBillAuthenticationInfoPojoList":null,"contactPersonDetails":null,"partnerAndDirector":null,"businessDetails":null,"creditorDebtorDetails":null,"monthlyDataDetails":null,"shareholdingDetails":null,"corporateRatingDetails":null,"marketInformation":null,"customerGroupCode":null,"customerGroupId":null}}]}');
            res.setStatusCode(200);
            return res;
        } 
    }
    
    // Mock class to simulate invalid response (forces exception)
    private class SMSHttpMockError implements HttpCalloutMock {
        public HTTPResponse respond(HTTPRequest req) {
            HttpResponse res = new HttpResponse();
            res.setHeader('Content-Type', 'application/json');
            res.setBody('INVALID_JSON');
            res.setStatusCode(400);
            return res;
        }
    }
    
    @IsTest
    static void testGetOverDue_Success() {
        Test.setMock(HttpCalloutMock.class, new SMSHttpMockSuccess());
        SHF_ServiceConsoleLMSControllerWrapper wrapper = new SHF_ServiceConsoleLMSControllerWrapper();
        
        Test.startTest();
        SHF_ServiceConsoleLMSControllerWrapper result =
            SHF_SearchCustomerLMSService.fetchCustomer('ACC123', wrapper);
        SHF_ServiceConsoleLMSControllerWrapper.getLMSWrapperData('ACC123');
        Test.stopTest();
        
    }
    
    @IsTest
    static void testGetOverDue_CatchBlock() {
        Test.setMock(HttpCalloutMock.class, new SMSHttpMockError());
        SHF_ServiceConsoleLMSControllerWrapper wrapper = new SHF_ServiceConsoleLMSControllerWrapper();
        
        Test.startTest();
        SHF_ServiceConsoleLMSControllerWrapper result =
            SHF_SearchCustomerLMSService.fetchCustomer('ACC123', wrapper);
        Test.stopTest();
        
    }
}